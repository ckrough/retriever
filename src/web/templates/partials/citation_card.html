<!-- Expandable citation card for a single source chunk -->
<details class="citation-card group border border-gray-200 rounded-lg overflow-hidden">
    <summary class="flex items-center gap-2 p-3 cursor-pointer hover:bg-gray-50 transition-colors">
        <!-- Expand/collapse icon -->
        <svg class="w-4 h-4 text-gray-400 transition-transform group-open:rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>

        <!-- Document info -->
        <div class="flex-1 min-w-0">
            <span class="font-medium text-gray-900 text-sm">{{ chunk.title or chunk.source }}</span>
            {% if chunk.section %}
            <span class="text-gray-400 mx-1">&rsaquo;</span>
            <span class="text-gray-600 text-sm">{{ chunk.section }}</span>
            {% endif %}
        </div>

        <!-- Relevance indicator -->
        {% if chunk.score >= 0.7 %}
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800" title="High relevance">
            High
        </span>
        {% elif chunk.score >= 0.5 %}
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-800" title="Medium relevance">
            Med
        </span>
        {% else %}
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-600" title="Lower relevance">
            Low
        </span>
        {% endif %}
    </summary>

    <!-- Expanded content: the actual chunk text -->
    <div class="p-3 pt-0 border-t border-gray-100 bg-gray-50">
        <div class="text-sm text-gray-600 whitespace-pre-wrap max-h-48 overflow-y-auto">{{ chunk.content }}</div>
        <div class="mt-2 text-xs text-gray-400">
            Source: {{ chunk.source }}
        </div>
    </div>
</details>
